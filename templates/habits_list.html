<h2 class="text-xl font-semibold mb-4">My Habits ({{ habits|length }})</h2>
{% if habits %}
    {% for habit in habits %}
    <div class="bg-white rounded-lg shadow p-4 mb-4">
        <div class="flex items-center justify-between mb-3">
            <div class="flex items-center gap-3">
                <div class="w-4 h-4 rounded-full" style="background-color: {{ habit.color }}"></div>
                <span>{{ habit.name }}</span>
            </div>
            <button hx-delete="/habits/{{ habit.id }}?user_id={{ user_id }}" hx-target="#habits-list" hx-swap="innerHTML" class="text-red-500 hover:text-red-700">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                </svg>
            </button>
        </div>

        <!-- Week Calendar -->
        <div class="grid grid-cols-7 gap-1">
            {% for i in range(7) %}
            <div class="flex flex-col items-center">
                <span class="text-xs text-gray-500 mb-1">{{ week_names[i] }}</span>
                {% set day_completed = habit.completions.get(week_days[i], False) %}
                <form hx-post="/completions" hx-target="this" hx-swap="outerHTML" hx-params="*" enctype="application/x-www-form-urlencoded" style="display: inline-block; margin: 0;">
                    <input type="hidden" name="habit_id" value="{{ habit.id }}">
                    <input type="hidden" name="date" value="{{ week_days[i] }}">
                    <input type="hidden" name="context" value="week">
                    <input type="hidden" name="user_id" value="{{ user_id }}">
                    <button 
                        type="submit"
                        class="w-10 h-10 rounded-lg flex items-center justify-center text-xs transition-all {% if day_completed %}text-white{% else %}bg-gray-200 hover:bg-gray-300{% endif %}"
                        style="{% if day_completed %}background-color: {{ habit.color }}{% endif %}"
                    >
                        {% if day_completed %}
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        {% else %}
                        {{ week_days[i].split('-')[2] }}
                        {% endif %}
                    </button>
                </form>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="bg-white rounded-lg shadow p-8 text-center text-gray-500">
        No habits yet. Add your first habit to get started!
    </div>
{% endif %}